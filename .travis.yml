---
language: shell

os:
  - linux

jobs:
  include:
    - name: "Focal Fossa Test Build"
      dist: focal
    - name: "Bionic Beaver Test Build"
      dist: bionic
    - name: "Xenial Xerus Test Build"
      dist: xenial

git:
  quiet: true
  depth: false

env:
  global:
    - MAKEFLAGS="-j 2"
    - secure: Lr+U2KhUnw7mnMg80LUFjyEB+Kd/sl8rFqczKPd7x6ssg0XD66TTBiq60/PFKhGaILyBHZTkYMO2qMx3aVsMth80d4lLQ0xCLMk2RgSKP2bQq6zK8eeajZwXpXs18mOyyJRUAJkgh8qAYh1YtUhGvXtjjWvnALTsVg/rbPOLnQuW0smeJybnfrElFYFTrWFWrReYOpyHn0VlnG6+KVTk2lJnmEN4OyAP82C5cwWgh5Als/IbAl2BDjZEEXSY5UxYF2x4inZ92vVyDmOqY24M094ulhnBqzB/SGStAS8C7QmEaNRTuEAFC0EluSnc+XDbsHItRUMizfJbVBcfP6/d5bO1//Oq3cI11UaS8VEVTo+dTJ4Ad1nFRRpR+F0a9qk/jCEyOZNZ7lC+SCqw+ZLkt2YG84d+JMINOTbPnJaycc7tsxGs3rKi6dI23RyB8oLctBSfYBB1QPgsEQMtePFncqwsgGSyutyGR9Bgs+elGBnP6gnD2ZnasQOEmWjeuqHQb1eQOusD9IIhU02PdMyRFq5PIlfbPSvErhlB0DOxXrZc+Tg5rqrQx9bXC+bugp1uD7zG3+RAO/W31e2phGQjIbo/4I2nojbsgvOPKcl27wTJdz22jvsjp3uP49bl7JYnFjbjYo4RLU6vUNvRed0aK1R9QFrNNWZPDTZNvoJRKCo=

addons:
  apt:
    update: true
    packages:
      - wget
      - jq
      - cmake
      - yasm
      - libde265-dev
      - libx265-dev

cache:
  directories:
    - /usr/local/src

script:
  - sudo bash imei.sh --travis --log-file "build.log" -- || exit 1

after_failure:
  - sudo tail -5 build.log
